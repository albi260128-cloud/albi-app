<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>êµ¬ì¸ê³µê³  ì˜¬ë¦¬ê¸° - ì•Œë¹„</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50">
  <div class="max-w-2xl mx-auto min-h-screen bg-white shadow-xl">
    <div class="sticky top-0 bg-white z-50 px-4 py-4 border-b flex items-center justify-between">
      <button onclick="history.back()" class="text-gray-600 hover:text-gray-800">
        <i class="fas fa-arrow-left mr-2"></i>ì·¨ì†Œ
      </button>
      <h1 class="font-bold text-lg">êµ¬ì¸ê³µê³  ì˜¬ë¦¬ê¸°</h1>
      <button onclick="submitJob()" id="submitBtn" class="text-orange-500 font-bold hover:text-orange-600">
        ì™„ë£Œ
      </button>
    </div>

    <div class="p-4 bg-orange-50 border-b">
      <div class="flex items-center space-x-3">
        <div class="text-3xl">ğŸª™</div>
        <div>
          <h3 class="font-bold text-orange-800">30 ì•Œë¹„í¬ì¸íŠ¸ ì°¨ê°</h3>
          <p class="text-sm text-orange-600">ê³µê³  ë“±ë¡ ì‹œ ìë™ìœ¼ë¡œ ì°¨ê°ë©ë‹ˆë‹¤</p>
        </div>
      </div>
    </div>

    <div class="p-4 space-y-6">
      <div>
        <label class="block font-bold mb-2">ê³µê³  ì œëª© *</label>
        <input type="text" id="title" required maxlength="50"
               class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-orange-500 focus:outline-none"
               placeholder="ì˜ˆ: í™ëŒ€ ê°ì„± ì¹´í˜ ì§ì› ëª¨ì§‘">
      </div>

      <div>
        <label class="block font-bold mb-2">ì¹´í…Œê³ ë¦¬ *</label>
        <div class="grid grid-cols-2 gap-3">
          <label class="cursor-pointer">
            <input type="radio" name="category" value="cafe" required class="hidden peer">
            <div class="p-4 border-2 border-gray-200 rounded-lg text-center peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">
              <div class="text-3xl mb-1">â˜•</div>
              <div class="font-bold">ì¹´í˜</div>
            </div>
          </label>
          <label class="cursor-pointer">
            <input type="radio" name="category" value="convenience" class="hidden peer">
            <div class="p-4 border-2 border-gray-200 rounded-lg text-center peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">
              <div class="text-3xl mb-1">ğŸª</div>
              <div class="font-bold">í¸ì˜ì </div>
            </div>
          </label>
          <label class="cursor-pointer">
            <input type="radio" name="category" value="restaurant" class="hidden peer">
            <div class="p-4 border-2 border-gray-200 rounded-lg text-center peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">
              <div class="text-3xl mb-1">ğŸ½ï¸</div>
              <div class="font-bold">ìŒì‹ì </div>
            </div>
          </label>
          <label class="cursor-pointer">
            <input type="radio" name="category" value="retail" class="hidden peer">
            <div class="p-4 border-2 border-gray-200 rounded-lg text-center peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">
              <div class="text-3xl mb-1">ğŸ‘•</div>
              <div class="font-bold">ë§¤ì¥</div>
            </div>
          </label>
        </div>
      </div>

      <div>
        <label class="block font-bold mb-2">ì‹œê¸‰ *</label>
        <div class="flex items-center space-x-2">
          <input type="number" id="hourlyWage" required min="10030" value="10030"
                 class="flex-1 px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-orange-500 focus:outline-none">
          <span class="font-bold text-gray-700">ì›</span>
        </div>
        <p class="text-xs text-orange-600 mt-1">2025ë…„ ìµœì €ì‹œê¸‰: 10,030ì›</p>
      </div>

      <div>
        <label class="block font-bold mb-2">ê·¼ë¬´ì§€ ì£¼ì†Œ *</label>
        <input type="text" id="address" required
               class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-orange-500 focus:outline-none"
               placeholder="ì˜ˆ: ì„œìš¸ ë§ˆí¬êµ¬ ì–‘í™”ë¡œ 160">
        <input type="text" id="location" required
               class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-orange-500 focus:outline-none mt-2"
               placeholder="ì§€ì—­ëª… (ì˜ˆ: ì„œìš¸ ë§ˆí¬êµ¬)">
        <input type="hidden" id="latitude" value="37.5665">
        <input type="hidden" id="longitude" value="126.9780">
      </div>

      <div>
        <label class="block font-bold mb-2">ê·¼ë¬´ ì‹œê°„ *</label>
        <input type="text" id="workHours" required
               class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-orange-500 focus:outline-none"
               placeholder="ì˜ˆ: 09:00-18:00">
      </div>

      <div>
        <label class="block font-bold mb-2">ê·¼ë¬´ ìš”ì¼ *</label>
        <div class="flex flex-wrap gap-2">
          <label class="cursor-pointer">
            <input type="checkbox" name="workDay" value="ì›”" class="hidden peer">
            <div class="px-4 py-2 border-2 border-gray-200 rounded-full peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">ì›”</div>
          </label>
          <label class="cursor-pointer">
            <input type="checkbox" name="workDay" value="í™”" class="hidden peer">
            <div class="px-4 py-2 border-2 border-gray-200 rounded-full peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">í™”</div>
          </label>
          <label class="cursor-pointer">
            <input type="checkbox" name="workDay" value="ìˆ˜" class="hidden peer">
            <div class="px-4 py-2 border-2 border-gray-200 rounded-full peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">ìˆ˜</div>
          </label>
          <label class="cursor-pointer">
            <input type="checkbox" name="workDay" value="ëª©" class="hidden peer">
            <div class="px-4 py-2 border-2 border-gray-200 rounded-full peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">ëª©</div>
          </label>
          <label class="cursor-pointer">
            <input type="checkbox" name="workDay" value="ê¸ˆ" class="hidden peer">
            <div class="px-4 py-2 border-2 border-gray-200 rounded-full peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">ê¸ˆ</div>
          </label>
          <label class="cursor-pointer">
            <input type="checkbox" name="workDay" value="í† " class="hidden peer">
            <div class="px-4 py-2 border-2 border-gray-200 rounded-full peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">í† </div>
          </label>
          <label class="cursor-pointer">
            <input type="checkbox" name="workDay" value="ì¼" class="hidden peer">
            <div class="px-4 py-2 border-2 border-gray-200 rounded-full peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">ì¼</div>
          </label>
        </div>
      </div>

      <div>
        <label class="block font-bold mb-2">íƒœê·¸ (ì„ íƒ)</label>
        <div class="flex flex-wrap gap-2">
          <label class="cursor-pointer">
            <input type="checkbox" name="tag" value="ì´ˆë³´í™˜ì˜" class="hidden peer">
            <div class="px-3 py-1 border-2 border-gray-200 rounded-full text-sm peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">#ì´ˆë³´í™˜ì˜</div>
          </label>
          <label class="cursor-pointer">
            <input type="checkbox" name="tag" value="ì£¼ë§ê·¼ë¬´" class="hidden peer">
            <div class="px-3 py-1 border-2 border-gray-200 rounded-full text-sm peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">#ì£¼ë§ê·¼ë¬´</div>
          </label>
          <label class="cursor-pointer">
            <input type="checkbox" name="tag" value="ì¥ê¸°ì•Œë°”" class="hidden peer">
            <div class="px-3 py-1 border-2 border-gray-200 rounded-full text-sm peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">#ì¥ê¸°ì•Œë°”</div>
          </label>
          <label class="cursor-pointer">
            <input type="checkbox" name="tag" value="ì‹ì‚¬ì œê³µ" class="hidden peer">
            <div class="px-3 py-1 border-2 border-gray-200 rounded-full text-sm peer-checked:border-orange-500 peer-checked:bg-orange-50 transition">#ì‹ì‚¬ì œê³µ</div>
          </label>
        </div>
      </div>

      <div>
        <label class="block font-bold mb-2">ìƒì„¸ ì„¤ëª… *</label>
        <textarea id="description" required rows="5" maxlength="500"
                  class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-orange-500 focus:outline-none resize-none"
                  placeholder="ì—…ë¬´ ë‚´ìš©, ìš°ëŒ€ì‚¬í•­, ë³µì§€ ë“±ì„ ìì„¸íˆ ì‘ì„±í•´ì£¼ì„¸ìš” (500ì ì´ë‚´)"></textarea>
      </div>

      <button type="button" onclick="submitJob()" 
              class="w-full bg-orange-500 text-white py-4 rounded-lg font-bold hover:bg-orange-600 transition text-lg">
        30P ì‚¬ìš©í•˜ê³  ê³µê³  ë“±ë¡í•˜ê¸°
      </button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
  <script>
    async function submitJob() {
      const category = document.querySelector('input[name="category"]:checked')?.value;
      const workDays = Array.from(document.querySelectorAll('input[name="workDay"]:checked'))
        .map(el => el.value);
      const tags = Array.from(document.querySelectorAll('input[name="tag"]:checked'))
        .map(el => el.value);

      if (!category) {
        alert('ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
      }

      if (workDays.length === 0) {
        alert('ê·¼ë¬´ ìš”ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
      }

      const userInfo = JSON.parse(localStorage.getItem('albi_user_info') || '{}');
      if (!userInfo.id) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        window.location.href = '/onboarding';
        return;
      }

      const address = document.getElementById('address').value;
      const lat = parseFloat(document.getElementById('latitude').value);
      const lng = parseFloat(document.getElementById('longitude').value);

      const jobData = {
        employerId: userInfo.id,
        title: document.getElementById('title').value,
        hourlyWage: parseInt(document.getElementById('hourlyWage').value),
        location: document.getElementById('location').value,
        description: document.getElementById('description').value,
        latitude: lat,
        longitude: lng,
        address: address,
        category,
        tags,
        workDays,
        workHours: document.getElementById('workHours').value
      };

      try {
        document.getElementById('submitBtn').textContent = 'ë“±ë¡ ì¤‘...';
        document.getElementById('submitBtn').disabled = true;

        const response = await axios.post('/api/jobs', jobData);

        if (response.data.success) {
          alert('ê³µê³ ê°€ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰');
          window.location.href = `/jobs`;
        } else {
          alert('ì˜¤ë¥˜: ' + response.data.error);
        }
      } catch (error) {
        console.error('Post job error:', error);
        alert('ê³µê³  ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      } finally {
        document.getElementById('submitBtn').textContent = 'ì™„ë£Œ';
        document.getElementById('submitBtn').disabled = false;
      }
    }
  </script>
</body>
</html>
