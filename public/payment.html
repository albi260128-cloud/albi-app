<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê²°ì œ - ì•Œë¹„</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://js.tosspayments.com/v1/payment"></script>
</head>
<body class="bg-gray-50">
  <div class="max-w-md mx-auto min-h-screen p-4">
    <!-- í—¤ë” -->
    <div class="text-center mb-8 pt-8">
      <div class="text-6xl mb-4">ğŸ’³</div>
      <h1 class="text-2xl font-bold mb-2">ì±„ìš© ì„±ê³µ ìˆ˜ìˆ˜ë£Œ</h1>
      <p class="text-gray-600">ì•Œë¹„ë¥¼ í†µí•œ ì„±ê³µì ì¸ ì±„ìš©ì„ ì¶•í•˜í•©ë‹ˆë‹¤!</p>
    </div>

    <!-- ê²°ì œ ì •ë³´ ì¹´ë“œ -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
      <h2 class="text-lg font-bold mb-4 flex items-center">
        <span class="mr-2">ğŸ’³</span>
        ê²°ì œ ì •ë³´
      </h2>
      
      <div class="space-y-3 text-sm">
        <div class="flex justify-between py-2 border-b border-gray-100">
          <span class="text-gray-600">ì§ë¬´</span>
          <span class="font-bold" id="jobTitle">í™ëŒ€ ì¹´í˜ ì•Œë°”</span>
        </div>
        <div class="flex justify-between py-2 border-b border-gray-100">
          <span class="text-gray-600">êµ¬ì¸ì</span>
          <span class="font-bold" id="employerName">ì´ì‚¬ì¥</span>
        </div>
        <div class="flex justify-between py-2 border-b border-gray-100">
          <span class="text-gray-600">ì„œë¹„ìŠ¤ ìˆ˜ìˆ˜ë£Œ</span>
          <span class="font-bold text-blue-600" id="amount">39,000ì›</span>
        </div>
      </div>

      <div class="mt-4 p-4 bg-blue-50 rounded-lg">
        <p class="text-xs text-blue-800">
          ğŸ’¡ <strong>ìˆ˜ìˆ˜ë£Œ ì•ˆë‚´:</strong><br>
          â€¢ ì±„ìš© ì„±ê³µì‹œì—ë§Œ ê²°ì œ<br>
          â€¢ 7ì¼ ì´ë‚´ í™˜ë¶ˆ ê°€ëŠ¥<br>
          â€¢ VAT í¬í•¨ ê¸ˆì•¡
        </p>
      </div>
    </div>

    <!-- ì•½ê´€ ë™ì˜ -->
    <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
      <h3 class="text-lg font-bold mb-4 flex items-center">
        <span class="mr-2">ğŸ›¡ï¸</span>
        ì•½ê´€ ë™ì˜
      </h3>
      
      <div class="space-y-4">
        <label class="flex items-start space-x-3 cursor-pointer group">
          <input type="checkbox" id="agreeTerms"
                 class="mt-1 w-5 h-5 text-orange-500 rounded focus:ring-orange-500">
          <span class="text-sm group-hover:text-orange-600">
            <strong class="text-red-500">[í•„ìˆ˜]</strong> ì•Œë¹„ ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€ì— ë™ì˜í•©ë‹ˆë‹¤
            <a href="/terms" class="ml-2 text-blue-500 underline text-xs">ë³´ê¸°</a>
          </span>
        </label>

        <label class="flex items-start space-x-3 cursor-pointer group">
          <input type="checkbox" id="agreeFee"
                 class="mt-1 w-5 h-5 text-orange-500 rounded focus:ring-orange-500">
          <span class="text-sm group-hover:text-orange-600">
            <strong class="text-red-500">[í•„ìˆ˜]</strong> ìˆ˜ìˆ˜ë£Œ ì •ì±…ì— ë™ì˜í•©ë‹ˆë‹¤
            <a href="#" onclick="showFeePolicy(); return false;" class="ml-2 text-blue-500 underline text-xs">ë³´ê¸°</a>
          </span>
        </label>

        <label class="flex items-start space-x-3 cursor-pointer group">
          <input type="checkbox" id="agreePayment"
                 class="mt-1 w-5 h-5 text-orange-500 rounded focus:ring-orange-500">
          <span class="text-sm group-hover:text-orange-600">
            <strong class="text-red-500">[í•„ìˆ˜]</strong> ì „ìê¸ˆìœµê±°ë˜ ì´ìš©ì•½ê´€ì— ë™ì˜í•©ë‹ˆë‹¤
            <a href="#" onclick="showPaymentTerms(); return false;" class="ml-2 text-blue-500 underline text-xs">ë³´ê¸°</a>
          </span>
        </label>
      </div>
    </div>

    <!-- ê²°ì œ ë²„íŠ¼ -->
    <button onclick="requestPayment()" id="payButton"
            class="w-full py-4 rounded-xl text-lg font-bold bg-gray-300 text-gray-500 cursor-not-allowed transition">
      ëª¨ë“  ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”
    </button>

    <p class="text-center text-xs text-gray-500 mt-4">
      ğŸ”’ ì•ˆì „í•œ ê²°ì œë¥¼ ìœ„í•´ í† ìŠ¤í˜ì´ë¨¼ì¸ ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤
    </p>

    <!-- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ -->
    <div class="text-center mt-6">
      <a href="/" class="text-gray-500 text-sm hover:text-gray-700">
        â† ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°
      </a>
    </div>
  </div>

  <script>
    // í† ìŠ¤í˜ì´ë¨¼ì¸  í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸ í‚¤
    const clientKey = 'test_ck_D5GePWvyJnrK0W0k6q8gLzN97Eoq';
    const amount = 39000;
    let tossPayments;

    // í† ìŠ¤í˜ì´ë¨¼ì¸  ì´ˆê¸°í™”
    async function initTossPayments() {
      try {
        tossPayments = TossPayments(clientKey);
        console.log('âœ… í† ìŠ¤í˜ì´ë¨¼ì¸  ì´ˆê¸°í™” ì™„ë£Œ');
      } catch (error) {
        console.error('âŒ í† ìŠ¤í˜ì´ë¨¼ì¸  ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
        alert('ê²°ì œ ì‹œìŠ¤í…œ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
      }
    }

    // ì•½ê´€ ë™ì˜ ì²´í¬
    function checkAgreements() {
      const terms = document.getElementById('agreeTerms').checked;
      const fee = document.getElementById('agreeFee').checked;
      const payment = document.getElementById('agreePayment').checked;
      
      const allChecked = terms && fee && payment;
      const button = document.getElementById('payButton');
      
      if (allChecked) {
        button.className = 'w-full py-4 rounded-xl text-lg font-bold bg-blue-500 text-white hover:bg-blue-600 shadow-lg transition cursor-pointer';
        button.textContent = '39,000ì› ê²°ì œí•˜ê¸°';
      } else {
        button.className = 'w-full py-4 rounded-xl text-lg font-bold bg-gray-300 text-gray-500 cursor-not-allowed transition';
        button.textContent = 'ëª¨ë“  ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”';
      }
      
      return allChecked;
    }

    // ê²°ì œ ìš”ì²­
    async function requestPayment() {
      if (!checkAgreements()) {
        alert('ëª¨ë“  ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”.');
        return;
      }

      if (!tossPayments) {
        alert('ê²°ì œ ì‹œìŠ¤í…œì´ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
        return;
      }

      // ê³ ìœ í•œ ì£¼ë¬¸ ID ìƒì„±
      const orderId = `ALBI_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
      const jobTitle = document.getElementById('jobTitle').textContent;
      const employerName = document.getElementById('employerName').textContent;

      console.log('ğŸ“ ê²°ì œ ìš”ì²­:', {
        orderId,
        amount,
        jobTitle,
        employerName
      });

      try {
        // í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ ìš”ì²­
        await tossPayments.requestPayment('ì¹´ë“œ', {
          amount: amount,
          orderId: orderId,
          orderName: `ì•Œë¹„ ì±„ìš© ìˆ˜ìˆ˜ë£Œ - ${jobTitle}`,
          customerName: employerName,
          successUrl: `${window.location.origin}/payment-success?orderId=${orderId}`,
          failUrl: `${window.location.origin}/payment-fail`,
        });
      } catch (error) {
        console.error('âŒ ê²°ì œ ì˜¤ë¥˜:', error);
        
        if (error.code === 'USER_CANCEL') {
          alert('ê²°ì œë¥¼ ì·¨ì†Œí•˜ì…¨ìŠµë‹ˆë‹¤.');
        } else if (error.code === 'INVALID_CARD_COMPANY') {
          alert('ìœ íš¨í•˜ì§€ ì•Šì€ ì¹´ë“œì…ë‹ˆë‹¤. ë‹¤ë¥¸ ì¹´ë“œë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.');
        } else {
          alert('ê²°ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\nì˜¤ë¥˜: ' + (error.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
        }
      }
    }

    // ìˆ˜ìˆ˜ë£Œ ì •ì±… ë³´ê¸°
    function showFeePolicy() {
      alert(`ğŸ“‹ ìˆ˜ìˆ˜ë£Œ ì •ì±…

â€¢ ì±„ìš© ì„±ê³µ ìˆ˜ìˆ˜ë£Œ: 39,000ì› (VAT í¬í•¨)
â€¢ ê²°ì œ ì‹œì : êµ¬ì¸ìê°€ êµ¬ì§ìë¥¼ ìµœì¢… ì„ íƒí•œ ì‹œì 
â€¢ í™˜ë¶ˆ ì •ì±…: 7ì¼ ì´ë‚´ 100% í™˜ë¶ˆ ê°€ëŠ¥
â€¢ ì·¨ì†Œ ìˆ˜ìˆ˜ë£Œ: ì—†ìŒ

ì•Œë¹„ëŠ” ì„±ê³µì ì¸ ì±„ìš©ì´ ì´ë£¨ì–´ì¡Œì„ ë•Œë§Œ ìˆ˜ìˆ˜ë£Œë¥¼ ë°›ìŠµë‹ˆë‹¤.
1ì‹œê°„ ì²´í—˜ ì§„í–‰ì—ëŠ” ìˆ˜ìˆ˜ë£Œê°€ ì—†ìŠµë‹ˆë‹¤.`);
    }

    // ì „ìê¸ˆìœµê±°ë˜ ì•½ê´€ ë³´ê¸°
    function showPaymentTerms() {
      alert(`ğŸ“‹ ì „ìê¸ˆìœµê±°ë˜ ì´ìš©ì•½ê´€ (ìš”ì•½)

ì œ1ì¡° (ëª©ì )
ë³¸ ì•½ê´€ì€ ì•Œë¹„ê°€ ì œê³µí•˜ëŠ” ì „ìê¸ˆìœµê±°ë˜ ì„œë¹„ìŠ¤ì— ê´€í•œ ì‚¬í•­ì„ ê·œì •í•©ë‹ˆë‹¤.

ì œ2ì¡° (ê±°ë˜ ì§€ì‹œì˜ ì² íšŒ)
ê²°ì œ ì™„ë£Œ ì „ê¹Œì§€ ê±°ë˜ ì§€ì‹œë¥¼ ì² íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì œ3ì¡° (ì˜¤ë¥˜ì˜ ì •ì •)
ì„œë¹„ìŠ¤ ì´ìš© ì¤‘ ì˜¤ë¥˜ê°€ ìˆëŠ” ê²½ìš° ì¦‰ì‹œ ì •ì •ì„ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì œ4ì¡° (ê°œì¸ì •ë³´ ë³´í˜¸)
ê²°ì œ ì •ë³´ëŠ” ì•ˆì „í•˜ê²Œ ì•”í˜¸í™”ë˜ì–´ ì²˜ë¦¬ë©ë‹ˆë‹¤.

ì „ì²´ ì•½ê´€ì€ ê²°ì œ ì™„ë£Œ í›„ ì´ë©”ì¼ë¡œ ë°œì†¡ë©ë‹ˆë‹¤.`);
    }

    // ì²´í¬ë°•ìŠ¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    document.getElementById('agreeTerms').addEventListener('change', checkAgreements);
    document.getElementById('agreeFee').addEventListener('change', checkAgreements);
    document.getElementById('agreePayment').addEventListener('change', checkAgreements);

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    window.onload = function() {
      // í† ìŠ¤í˜ì´ë¨¼ì¸  ì´ˆê¸°í™”
      initTossPayments();
      
      // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
      const urlParams = new URLSearchParams(window.location.search);
      const job = urlParams.get('job');
      const employer = urlParams.get('employer');
      
      if (job) {
        document.getElementById('jobTitle').textContent = decodeURIComponent(job);
      }
      if (employer) {
        document.getElementById('employerName').textContent = decodeURIComponent(employer);
      }

      console.log('ğŸ’³ ê²°ì œ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
      console.log('ğŸ“ ì§ë¬´:', document.getElementById('jobTitle').textContent);
      console.log('ğŸ“ êµ¬ì¸ì:', document.getElementById('employerName').textContent);
    };

    // í˜ì´ì§€ ì´íƒˆ ë°©ì§€ (ì•½ê´€ ë™ì˜ í›„)
    window.addEventListener('beforeunload', function(e) {
      const allChecked = checkAgreements();
      if (allChecked) {
        e.preventDefault();
        e.returnValue = '';
        return 'ê²°ì œë¥¼ ì§„í–‰í•˜ì§€ ì•Šìœ¼ì‹œê² ìŠµë‹ˆê¹Œ?';
      }
    });
  </script>
</body>
</html>
