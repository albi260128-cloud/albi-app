<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë§ˆì´í˜ì´ì§€ - ì•Œë¹„</title>
  <link href="/styles.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Pretendard', 'Apple SD Gothic Neo', sans-serif;
      background: #f5f7fa;
      min-height: 100vh;
      padding-bottom: 80px;
    }

    /* í—¤ë” */
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 24px 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .back-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .back-btn:hover {
      background: rgba(255,255,255,0.3);
    }

    .header-title {
      font-size: 24px;
      font-weight: 700;
    }

    .logout-btn {
      padding: 10px 20px;
      background: rgba(255,255,255,0.2);
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 8px;
      color: white;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .logout-btn:hover {
      background: rgba(255,255,255,0.3);
    }

    /* ì»¨í…Œì´ë„ˆ */
    .container {
      max-width: 1200px;
      margin: -40px auto 0;
      padding: 0 20px;
    }

    /* í”„ë¡œí•„ ì¹´ë“œ */
    .profile-card {
      background: white;
      border-radius: 16px;
      padding: 32px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      margin-bottom: 24px;
    }

    .profile-header {
      display: flex;
      align-items: center;
      gap: 24px;
      margin-bottom: 32px;
      padding-bottom: 24px;
      border-bottom: 1px solid #e5e7eb;
    }

    .profile-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      color: white;
      font-weight: 700;
      flex-shrink: 0;
    }

    .profile-info-header {
      flex: 1;
    }

    .profile-name {
      font-size: 24px;
      font-weight: 700;
      color: #1f2937;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .badge {
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
    }

    .badge-jobseeker {
      background: #dbeafe;
      color: #1e40af;
    }

    .badge-employer {
      background: #fef3c7;
      color: #92400e;
    }

    .badge-verified {
      background: #d1fae5;
      color: #065f46;
    }

    .profile-email {
      font-size: 14px;
      color: #6b7280;
    }

    .profile-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
    }

    .profile-item {
      padding: 16px;
      background: #f9fafb;
      border-radius: 12px;
    }

    .profile-label {
      font-size: 12px;
      color: #6b7280;
      margin-bottom: 4px;
      font-weight: 500;
    }

    .profile-value {
      font-size: 16px;
      color: #1f2937;
      font-weight: 600;
    }

    /* ë¡œê·¸ì¸ ì •ë³´ */
    .login-info-section {
      background: white;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      margin-bottom: 24px;
    }

    .section-title {
      font-size: 18px;
      font-weight: 700;
      color: #1f2937;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .login-method {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px;
      background: #f9fafb;
      border-radius: 12px;
      margin-bottom: 12px;
    }

    .login-method-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }

    .login-method-icon.email {
      background: #dbeafe;
      color: #1e40af;
    }

    .login-method-icon.social {
      background: #fef3c7;
      color: #92400e;
    }

    .login-method-info {
      flex: 1;
    }

    .login-method-type {
      font-size: 14px;
      font-weight: 600;
      color: #1f2937;
    }

    .login-method-detail {
      font-size: 12px;
      color: #6b7280;
      margin-top: 2px;
    }

    /* íƒ­ */
    .tabs {
      display: flex;
      gap: 8px;
      background: white;
      border-radius: 16px;
      padding: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      margin-bottom: 24px;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    .tabs::-webkit-scrollbar {
      display: none;
    }

    .tab {
      padding: 12px 24px;
      border-radius: 12px;
      border: none;
      background: transparent;
      color: #6b7280;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
      flex-shrink: 0;
    }

    .tab:hover {
      background: #f9fafb;
    }

    .tab.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    /* íƒ­ ì»¨í…ì¸  */
    .tab-content {
      display: none;
      background: white;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

    .tab-content.active {
      display: block;
    }

    /* í¼ */
    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: #374151;
      margin-bottom: 8px;
    }

    .form-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 14px;
      transition: all 0.2s;
    }

    .form-input:focus {
      outline: none;
      border-color: #667eea;
    }

    .form-input:disabled {
      background: #f9fafb;
      cursor: not-allowed;
    }

    /* ë²„íŠ¼ */
    .btn {
      padding: 12px 24px;
      border-radius: 12px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      border: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      justify-content: center;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #374151;
    }

    .btn-secondary:hover {
      background: #d1d5db;
    }

    .btn-danger {
      background: #ef4444;
      color: white;
    }

    .btn-danger:hover {
      background: #dc2626;
    }

    .btn-block {
      width: 100%;
    }

    /* ë¹ˆ ìƒíƒœ */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #6b7280;
    }

    .empty-state i {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.3;
    }

    .empty-state-title {
      font-size: 18px;
      font-weight: 600;
      color: #374151;
      margin-bottom: 8px;
    }

    .empty-state-text {
      font-size: 14px;
    }

    /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
    @media (max-width: 768px) {
      .header-title {
        font-size: 20px;
      }

      .container {
        padding: 0 16px;
        margin-top: -20px;
      }

      .profile-card {
        padding: 20px;
      }

      .profile-header {
        flex-direction: column;
        text-align: center;
        gap: 16px;
      }

      .profile-name {
        font-size: 20px;
        flex-direction: column;
        gap: 8px;
      }

      .profile-avatar {
        width: 64px;
        height: 64px;
        font-size: 24px;
      }

      .profile-grid {
        grid-template-columns: 1fr;
      }

      .tabs {
        gap: 4px;
        padding: 6px;
      }

      .tab {
        padding: 10px 16px;
        font-size: 13px;
      }

      .tab-content {
        padding: 20px;
      }

      .logout-btn span {
        display: none;
      }

      .back-btn {
        width: 36px;
        height: 36px;
        font-size: 16px;
      }
    }

    /* êµ¬ì¸ì ì¸ì¦ ê´€ë ¨ ìŠ¤íƒ€ì¼ */
    .status-box {
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 24px;
    }

    .status-box.info {
      background: #f0f9ff;
      border: 2px solid #bae6fd;
    }

    .status-box.warning {
      background: #fef3c7;
      border: 2px solid #fcd34d;
    }

    .status-box.success {
      background: #d1fae5;
      border: 2px solid #6ee7b7;
    }

    .status-box.error {
      background: #fee2e2;
      border: 2px solid #fca5a5;
    }

    .status-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }

    .status-icon {
      font-size: 24px;
    }

    .status-title {
      font-size: 16px;
      font-weight: 700;
      color: #1f2937;
    }

    .status-text {
      font-size: 14px;
      color: #4b5563;
      line-height: 1.5;
    }

    .file-upload-area {
      border: 2px dashed #d1d5db;
      border-radius: 12px;
      padding: 32px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
      margin-bottom: 20px;
    }

    .file-upload-area:hover {
      border-color: #667eea;
      background: #f9fafb;
    }

    .file-upload-area.has-file {
      border-style: solid;
      border-color: #10b981;
      background: #d1fae5;
    }

    .file-preview {
      margin-top: 16px;
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
    }

    .file-preview img {
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .remove-file-btn {
      margin-top: 12px;
      padding: 8px 16px;
      background: #ef4444;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 13px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- í—¤ë” -->
  <div class="header">
    <div class="header-content">
      <div class="header-left">
        <button class="back-btn" onclick="window.location.href='/'">
          <i class="fas fa-arrow-left"></i>
        </button>
        <h1 class="header-title">ë§ˆì´í˜ì´ì§€</h1>
      </div>
      <button class="logout-btn" onclick="logout()">
        <i class="fas fa-sign-out-alt"></i>
        <span>ë¡œê·¸ì•„ì›ƒ</span>
      </button>
    </div>
  </div>

  <!-- ì»¨í…Œì´ë„ˆ -->
  <div class="container">
    <!-- í”„ë¡œí•„ ì¹´ë“œ -->
    <div class="profile-card">
      <div class="profile-header">
        <div class="profile-avatar" id="profileAvatar">A</div>
        <div class="profile-info-header">
          <div class="profile-name">
            <span id="profileName">ë¡œë”©ì¤‘...</span>
            <span class="badge badge-jobseeker" id="userTypeBadge">êµ¬ì§ì</span>
            <span class="badge badge-verified" id="verifiedBadge" style="display: none;">
              <i class="fas fa-check-circle"></i> ì¸ì¦ì™„ë£Œ
            </span>
          </div>
          <div class="profile-email" id="profileEmail">-</div>
        </div>
      </div>

      <div class="profile-grid">
        <div class="profile-item">
          <div class="profile-label">ì´ë¦„</div>
          <div class="profile-value" id="userName">-</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">íœ´ëŒ€í° ë²ˆí˜¸</div>
          <div class="profile-value" id="userPhone">-</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">ì´ë©”ì¼</div>
          <div class="profile-value" id="userEmail">-</div>
        </div>
        <div class="profile-item">
          <div class="profile-label">ì‚¬ìš©ì ìœ í˜•</div>
          <div class="profile-value" id="userTypeText">-</div>
        </div>
      </div>
    </div>

    <!-- ë¡œê·¸ì¸ ì •ë³´ -->
    <div class="login-info-section">
      <h2 class="section-title">
        <i class="fas fa-key"></i>
        ë¡œê·¸ì¸ ì •ë³´
      </h2>
      <div id="loginMethodsContainer">
        <!-- ë¡œê·¸ì¸ ë°©ë²•ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
      </div>
    </div>

    <!-- íƒ­ -->
    <div class="tabs">
      <button class="tab active" onclick="switchTab('profile')">
        <i class="fas fa-user"></i> í”„ë¡œí•„ ìˆ˜ì •
      </button>
      <button class="tab" onclick="switchTab('password')">
        <i class="fas fa-lock"></i> ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
      </button>
      <button class="tab" onclick="switchTab('employer')">
        <i class="fas fa-building"></i> êµ¬ì¸ì ì¸ì¦
      </button>
      <button class="tab" onclick="switchTab('interview')">
        <i class="fas fa-clipboard-list"></i> ë©´ì ‘ ê²°ê³¼
      </button>
    </div>

    <!-- í”„ë¡œí•„ ìˆ˜ì • íƒ­ -->
    <div class="tab-content active" id="tabProfile">
      <h3 class="section-title">í”„ë¡œí•„ ì •ë³´ ìˆ˜ì •</h3>
      <form id="profileForm">
        <div class="form-group">
          <label class="form-label">ì´ë¦„</label>
          <input type="text" class="form-input" id="editName" required>
        </div>
        <div class="form-group">
          <label class="form-label">íœ´ëŒ€í° ë²ˆí˜¸</label>
          <input type="tel" class="form-input" id="editPhone" disabled>
        </div>
        <div class="form-group">
          <label class="form-label">ì´ë©”ì¼</label>
          <input type="email" class="form-input" id="editEmail">
        </div>
        <button type="submit" class="btn btn-primary btn-block">
          <i class="fas fa-save"></i> ì €ì¥í•˜ê¸°
        </button>
      </form>
    </div>

    <!-- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ íƒ­ -->
    <div class="tab-content" id="tabPassword">
      <h3 class="section-title">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</h3>
      <form id="passwordForm">
        <div class="form-group">
          <label class="form-label">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸</label>
          <input type="password" class="form-input" id="currentPassword" required>
        </div>
        <div class="form-group">
          <label class="form-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
          <input type="password" class="form-input" id="newPassword" required minlength="8">
        </div>
        <div class="form-group">
          <label class="form-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
          <input type="password" class="form-input" id="confirmPassword" required minlength="8">
        </div>
        <button type="submit" class="btn btn-primary btn-block">
          <i class="fas fa-key"></i> ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
        </button>
      </form>
    </div>

    <!-- êµ¬ì¸ì ì¸ì¦ íƒ­ -->
    <div class="tab-content" id="tabEmployer">
      <h3 class="section-title">êµ¬ì¸ì ì¸ì¦</h3>
      
      <!-- ì¸ì¦ ìƒíƒœ -->
      <div id="employerStatus">
        <!-- ì¸ì¦ ìƒíƒœê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
      </div>

      <!-- ì¸ì¦ ì‹ ì²­ í¼ -->
      <div id="employerVerificationForm" style="display: none;">
        <div class="form-group">
          <label class="form-label">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸</label>
          <input type="text" class="form-input" id="verifyBusinessNumber" placeholder="123-45-67890">
        </div>
        
        <div class="form-group">
          <label class="form-label">ì‚¬ì—…ìëª… (ìƒí˜¸ëª…)</label>
          <input type="text" class="form-input" id="verifyBusinessName" placeholder="ì£¼ì‹íšŒì‚¬ ì•Œë¹„">
        </div>
        
        <div class="form-group">
          <label class="form-label">ì‚¬ì—…ìë“±ë¡ì¦ ì—…ë¡œë“œ</label>
          <input type="file" id="verifyBusinessFile" accept="image/jpeg,image/jpg,image/png" style="display: none;" onchange="handleVerificationFileUpload(event)">
          <div class="file-upload-area" id="uploadArea" onclick="document.getElementById('verifyBusinessFile').click()">
            <i class="fas fa-cloud-upload-alt" style="font-size: 48px; color: #9ca3af; margin-bottom: 12px;"></i>
            <div style="font-size: 16px; font-weight: 600; color: #374151; margin-bottom: 8px;">
              íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”
            </div>
            <div style="font-size: 14px; color: #6b7280;">
              JPG, PNG íŒŒì¼ë§Œ ê°€ëŠ¥ (ìµœëŒ€ 5MB)
            </div>
          </div>
          <div id="verificationFilePreview" class="file-preview" style="display: none;"></div>
        </div>
        
        <button type="button" id="submitVerificationButton" onclick="submitEmployerVerification()" class="btn btn-primary btn-block" disabled>
          <i class="fas fa-paper-plane"></i> ì¸ì¦ ì‹ ì²­í•˜ê¸°
        </button>
      </div>
    </div>

    <!-- ë©´ì ‘ ê²°ê³¼ íƒ­ -->
    <div class="tab-content" id="tabInterview">
      <h3 class="section-title">ë©´ì ‘ ê²°ê³¼</h3>
      <div id="interviewResults">
        <!-- ë©´ì ‘ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
      </div>
    </div>
  </div>

  <script>
    let currentUser = null;
    let userType = null;
    let verificationBusinessFile = null;

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¡œê·¸ì¸ ì²´í¬ ë° ë°ì´í„° ë¡œë“œ
    window.addEventListener('DOMContentLoaded', async function() {
      const userId = localStorage.getItem('albi_user_id');
      const userName = localStorage.getItem('albi_user_name');
      const savedUserType = localStorage.getItem('albi_user_type');
      const sessionToken = localStorage.getItem('albi_session_token');
      
      if (!userId || !sessionToken) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        window.location.href = '/login.html';
        return;
      }
      
      userType = savedUserType;
      
      // í”„ë¡œí•„ ì •ë³´ ë¡œë“œ
      await loadProfile();
      
      // ë©´ì ‘ ê²°ê³¼ ë¡œë“œ
      await loadInterviewResults();
    });

    // í”„ë¡œí•„ ì •ë³´ ë¡œë“œ
    async function loadProfile() {
      try {
        const sessionToken = localStorage.getItem('albi_session_token');
        const response = await fetch('/api/auth/me', {
          headers: {
            'Authorization': `Bearer ${sessionToken}`
          }
        });
        
        const data = await response.json();
        
        if (data.success) {
          currentUser = data.data;
          
          // í”„ë¡œí•„ í—¤ë” ì •ë³´
          const firstLetter = currentUser.name.charAt(0).toUpperCase();
          document.getElementById('profileAvatar').textContent = firstLetter;
          document.getElementById('profileName').textContent = currentUser.name;
          document.getElementById('profileEmail').textContent = currentUser.email || 'ì´ë©”ì¼ ë¯¸ë“±ë¡';
          
          // ì‚¬ìš©ì ìœ í˜• ë°°ì§€
          const badge = document.getElementById('userTypeBadge');
          if (currentUser.user_type === 'employer') {
            badge.textContent = 'êµ¬ì¸ì';
            badge.className = 'badge badge-employer';
          } else {
            badge.textContent = 'êµ¬ì§ì';
            badge.className = 'badge badge-jobseeker';
          }
          
          // ì¸ì¦ ë°°ì§€
          if (currentUser.business_registration_verified) {
            document.getElementById('verifiedBadge').style.display = 'inline-flex';
          }
          
          // í”„ë¡œí•„ ê·¸ë¦¬ë“œ ì •ë³´
          document.getElementById('userName').textContent = currentUser.name;
          document.getElementById('userPhone').textContent = currentUser.phone;
          document.getElementById('userEmail').textContent = currentUser.email || 'ë¯¸ë“±ë¡';
          document.getElementById('userTypeText').textContent = currentUser.user_type === 'employer' ? 'êµ¬ì¸ì' : 'êµ¬ì§ì';
          
          // ë¡œê·¸ì¸ ì •ë³´ í‘œì‹œ
          displayLoginInfo();
          
          // í”„ë¡œí•„ ìˆ˜ì • í¼ì— ë°ì´í„° ì±„ìš°ê¸°
          document.getElementById('editName').value = currentUser.name;
          document.getElementById('editPhone').value = currentUser.phone;
          document.getElementById('editEmail').value = currentUser.email || '';
        }
      } catch (error) {
        console.error('í”„ë¡œí•„ ë¡œë“œ ì‹¤íŒ¨:', error);
      }
    }

    // ë¡œê·¸ì¸ ì •ë³´ í‘œì‹œ
    function displayLoginInfo() {
      const container = document.getElementById('loginMethodsContainer');
      
      if (currentUser.social_provider) {
        // ì†Œì…œ ë¡œê·¸ì¸
        const providerNames = {
          'kakao': 'ì¹´ì¹´ì˜¤',
          'naver': 'ë„¤ì´ë²„',
          'google': 'êµ¬ê¸€'
        };
        
        const providerName = providerNames[currentUser.social_provider] || currentUser.social_provider;
        
        container.innerHTML = `
          <div class="login-method">
            <div class="login-method-icon social">
              <i class="fas fa-users"></i>
            </div>
            <div class="login-method-info">
              <div class="login-method-type">ì†Œì…œ ë¡œê·¸ì¸</div>
              <div class="login-method-detail">${providerName}ë¡œ ë¡œê·¸ì¸ ì¤‘ì…ë‹ˆë‹¤</div>
            </div>
          </div>
        `;
      } else {
        // ì´ë©”ì¼/ì „í™”ë²ˆí˜¸ ë¡œê·¸ì¸
        container.innerHTML = `
          <div class="login-method">
            <div class="login-method-icon email">
              <i class="fas fa-envelope"></i>
            </div>
            <div class="login-method-info">
              <div class="login-method-type">ì´ë©”ì¼ ë¡œê·¸ì¸</div>
              <div class="login-method-detail">${currentUser.email || currentUser.phone}</div>
            </div>
          </div>
          ${!currentUser.password_hash ? `
            <div style="margin-top: 12px; padding: 12px; background: #fef3c7; border-radius: 8px; font-size: 13px; color: #92400e;">
              <i class="fas fa-info-circle"></i> ë¹„ë°€ë²ˆí˜¸ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•˜ë©´ ë” ì•ˆì „í•˜ê²Œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
          ` : ''}
        `;
      }
    }

    // ë©´ì ‘ ê²°ê³¼ ë¡œë“œ
    async function loadInterviewResults() {
      try {
        const sessionToken = localStorage.getItem('albi_session_token');
        const response = await fetch('/api/mypage/interview-results', {
          headers: {
            'Authorization': `Bearer ${sessionToken}`
          }
        });
        
        const data = await response.json();
        const container = document.getElementById('interviewResults');
        
        if (data.success && data.data && data.data.length > 0) {
          container.innerHTML = data.data.map(result => `
            <div class="profile-item" style="padding: 16px; background: #f9fafb; border-radius: 12px; margin-bottom: 12px;">
              <div style="display: flex; justify-content: space-between; align-items: start;">
                <div>
                  <div style="font-weight: 600; margin-bottom: 8px;">${result.job_title}</div>
                  <div style="font-size: 14px; color: #6b7280;">${result.company_name}</div>
                  <div style="font-size: 13px; color: #9ca3af; margin-top: 4px;">
                    ${new Date(result.interview_date).toLocaleDateString('ko-KR')}
                  </div>
                </div>
                <div style="padding: 4px 12px; background: ${result.status === 'passed' ? '#d1fae5' : '#fee2e2'}; color: ${result.status === 'passed' ? '#065f46' : '#991b1b'}; border-radius: 12px; font-size: 12px; font-weight: 600;">
                  ${result.status === 'passed' ? 'í•©ê²©' : 'ë¶ˆí•©ê²©'}
                </div>
              </div>
              ${result.feedback ? `
                <div style="margin-top: 12px; padding: 12px; background: white; border-radius: 8px; font-size: 13px; color: #4b5563;">
                  ${result.feedback}
                </div>
              ` : ''}
            </div>
          `).join('');
        } else {
          container.innerHTML = `
            <div class="empty-state">
              <i class="fas fa-clipboard-list"></i>
              <div class="empty-state-title">ë©´ì ‘ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>
              <div class="empty-state-text">ë©´ì ‘ì„ ì§„í–‰í•˜ë©´ ì´ê³³ì—ì„œ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
            </div>
          `;
        }
      } catch (error) {
        console.error('ë©´ì ‘ ê²°ê³¼ ë¡œë“œ ì‹¤íŒ¨:', error);
        document.getElementById('interviewResults').innerHTML = `
          <div class="empty-state">
            <i class="fas fa-exclamation-triangle"></i>
            <div class="empty-state-title">ë¡œë“œ ì‹¤íŒ¨</div>
            <div class="empty-state-text">ë©´ì ‘ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>
          </div>
        `;
      }
    }

    // íƒ­ ì „í™˜
    function switchTab(tabName) {
      // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // ëª¨ë“  íƒ­ ì»¨í…ì¸  ìˆ¨ê¸°ê¸°
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });
      
      // ì„ íƒëœ íƒ­ í™œì„±í™”
      event.target.classList.add('active');
      
      // ì„ íƒëœ íƒ­ ì»¨í…ì¸  í‘œì‹œ
      const contentId = 'tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1);
      document.getElementById(contentId).classList.add('active');
      
      // êµ¬ì¸ì ì¸ì¦ íƒ­ì´ë©´ ìƒíƒœ ë¡œë“œ
      if (tabName === 'employer') {
        loadEmployerVerificationStatus();
      }
    }

    // í”„ë¡œí•„ ìˆ˜ì • í¼ ì œì¶œ
    document.getElementById('profileForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const name = document.getElementById('editName').value;
      const email = document.getElementById('editEmail').value;
      
      try {
        const sessionToken = localStorage.getItem('albi_session_token');
        const response = await fetch('/api/mypage/profile', {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${sessionToken}`
          },
          body: JSON.stringify({ name, email })
        });
        
        const data = await response.json();
        
        if (data.success) {
          alert('âœ… í”„ë¡œí•„ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!');
          localStorage.setItem('albi_user_name', name);
          await loadProfile();
        } else {
          alert('âŒ í”„ë¡œí•„ ìˆ˜ì • ì‹¤íŒ¨: ' + (data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
        }
      } catch (error) {
        console.error('í”„ë¡œí•„ ìˆ˜ì • ì˜¤ë¥˜:', error);
        alert('âŒ í”„ë¡œí•„ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      }
    });

    // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í¼ ì œì¶œ
    document.getElementById('passwordForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const currentPassword = document.getElementById('currentPassword').value;
      const newPassword = document.getElementById('newPassword').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      
      if (newPassword !== confirmPassword) {
        alert('ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
        return;
      }
      
      if (newPassword.length < 8) {
        alert('ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
        return;
      }
      
      try {
        const sessionToken = localStorage.getItem('albi_session_token');
        const response = await fetch('/api/mypage/password', {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${sessionToken}`
          },
          body: JSON.stringify({ currentPassword, newPassword })
        });
        
        const data = await response.json();
        
        if (data.success) {
          alert('âœ… ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!');
          document.getElementById('passwordForm').reset();
        } else {
          alert('âŒ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹¤íŒ¨: ' + (data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
        }
      } catch (error) {
        console.error('ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì˜¤ë¥˜:', error);
        alert('âŒ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      }
    });

    // ë¡œê·¸ì•„ì›ƒ
    async function logout() {
      if (!confirm('ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        return;
      }
      
      const sessionToken = localStorage.getItem('albi_session_token');
      
      try {
        if (sessionToken) {
          await fetch('/api/auth/logout', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ sessionToken })
          });
        }
      } catch (error) {
        console.error('Logout error:', error);
      } finally {
        localStorage.removeItem('albi_user_id');
        localStorage.removeItem('albi_user_name');
        localStorage.removeItem('albi_user_type');
        localStorage.removeItem('albi_session_token');
        localStorage.removeItem('albi_session_user_id');
        localStorage.removeItem('albi_remember');
        
        window.location.href = '/login.html';
      }
    }

    // ==========================================
    // êµ¬ì¸ì ì¸ì¦ ê´€ë ¨ í•¨ìˆ˜ë“¤
    // ==========================================

    // êµ¬ì¸ì ì¸ì¦ ìƒíƒœ ë¡œë“œ
    async function loadEmployerVerificationStatus() {
      try {
        const sessionToken = localStorage.getItem('albi_session_token');
        const response = await fetch('/api/employer/verification-status', {
          headers: {
            'Authorization': `Bearer ${sessionToken}`
          }
        });
        
        const data = await response.json();
        const statusDiv = document.getElementById('employerStatus');
        const formDiv = document.getElementById('employerVerificationForm');
        
        if (data.success && data.status) {
          const status = data.status;
          
          // ì´ë¯¸ ì¸ì¦ëœ ê²½ìš°
          if (status === 'approved' || currentUser?.business_registration_verified) {
            statusDiv.innerHTML = `
              <div class="status-box success">
                <div class="status-header">
                  <span class="status-icon">âœ…</span>
                  <span class="status-title">êµ¬ì¸ì ì¸ì¦ ì™„ë£Œ</span>
                </div>
                <div class="status-text">
                  ì‚¬ì—…ìë“±ë¡ì¦ì´ ì¸ì¦ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ê³µê³ ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </div>
                ${currentUser?.business_registration_number ? `
                  <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #6ee7b7;">
                    <div style="font-size: 14px; color: #065f46; margin-bottom: 4px;">
                      <strong>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸:</strong> ${currentUser.business_registration_number}
                    </div>
                    ${currentUser?.business_name ? `
                      <div style="font-size: 14px; color: #065f46;">
                        <strong>ì‚¬ì—…ìëª…:</strong> ${currentUser.business_name}
                      </div>
                    ` : ''}
                  </div>
                ` : ''}
              </div>
            `;
            formDiv.style.display = 'none';
          }
          // ì‹¬ì‚¬ ëŒ€ê¸° ì¤‘
          else if (status === 'pending') {
            statusDiv.innerHTML = `
              <div class="status-box warning">
                <div class="status-header">
                  <span class="status-icon">ğŸ•</span>
                  <span class="status-title">ì¸ì¦ ì‹¬ì‚¬ ëŒ€ê¸° ì¤‘</span>
                </div>
                <div class="status-text">
                  ì‚¬ì—…ìë“±ë¡ì¦ ì‹¬ì‚¬ê°€ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ìµœëŒ€ 1-2ì¼ ì •ë„ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </div>
              </div>
            `;
            formDiv.style.display = 'none';
          }
          // ê±°ì ˆë¨
          else if (status === 'rejected') {
            const rejectionReason = data.rejection_reason || 'ì‚¬ì—…ìë“±ë¡ì¦ ì •ë³´ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
            statusDiv.innerHTML = `
              <div class="status-box error">
                <div class="status-header">
                  <span class="status-icon">âŒ</span>
                  <span class="status-title">ì¸ì¦ì´ ê±°ì ˆë˜ì—ˆìŠµë‹ˆë‹¤</span>
                </div>
                <div class="status-text">
                  ${rejectionReason}
                </div>
                <button onclick="document.getElementById('employerVerificationForm').style.display='block'; document.getElementById('employerStatus').innerHTML='';" class="btn btn-danger" style="margin-top: 16px;">
                  ë‹¤ì‹œ ì‹ ì²­í•˜ê¸°
                </button>
              </div>
            `;
            formDiv.style.display = 'none';
          }
          // ì•„ì§ ì‹ ì²­ ì•ˆí•¨
          else {
            statusDiv.innerHTML = `
              <div class="status-box info">
                <div class="status-header">
                  <span class="status-icon">â„¹ï¸</span>
                  <span class="status-title">êµ¬ì¸ì ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤</span>
                </div>
                <div class="status-text">
                  ê³µê³ ë¥¼ ì‘ì„±í•˜ë ¤ë©´ ì‚¬ì—…ìë“±ë¡ì¦ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.
                </div>
              </div>
            `;
            formDiv.style.display = 'block';
          }
        } else {
          // ê¸°ë³¸ ìƒíƒœ
          statusDiv.innerHTML = `
            <div class="status-box info">
              <div class="status-header">
                <span class="status-icon">â„¹ï¸</span>
                <span class="status-title">êµ¬ì¸ì ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤</span>
              </div>
              <div class="status-text">
                ê³µê³ ë¥¼ ì‘ì„±í•˜ë ¤ë©´ ì‚¬ì—…ìë“±ë¡ì¦ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.
              </div>
            </div>
          `;
          formDiv.style.display = 'block';
        }
      } catch (error) {
        console.error('êµ¬ì¸ì ì¸ì¦ ìƒíƒœ ë¡œë“œ ì‹¤íŒ¨:', error);
      }
    }

    // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
    async function handleVerificationFileUpload(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      const maxSize = 5 * 1024 * 1024; // 5MB
      const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png'];
      
      if (file.size > maxSize) {
        alert('íŒŒì¼ í¬ê¸°ëŠ” 5MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        event.target.value = '';
        return;
      }
      
      if (!allowedTypes.includes(file.type)) {
        alert('JPG, PNG íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        event.target.value = '';
        return;
      }
      
      verificationBusinessFile = file;
      
      const uploadArea = document.getElementById('uploadArea');
      uploadArea.classList.add('has-file');
      uploadArea.innerHTML = `
        <i class="fas fa-spinner fa-spin" style="font-size: 48px; color: #667eea; margin-bottom: 12px;"></i>
        <div style="font-size: 16px; font-weight: 600; color: #374151; margin-bottom: 8px;">
          OCR ì¸ì‹ ì¤‘...
        </div>
        <div style="font-size: 14px; color: #6b7280;">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</div>
      `;
      
      // OCR ì¸ì‹
      try {
        console.log('ğŸ“„ ì‚¬ì—…ìë“±ë¡ì¦ OCR ì¸ì‹ ì‹œì‘...');
        
        const { createWorker } = Tesseract;
        const worker = await createWorker('kor+eng', 1, {
          logger: m => {
            if (m.status === 'recognizing text') {
              const progress = Math.round(m.progress * 100);
              uploadArea.innerHTML = `
                <i class="fas fa-spinner fa-spin" style="font-size: 48px; color: #667eea; margin-bottom: 12px;"></i>
                <div style="font-size: 16px; font-weight: 600; color: #374151; margin-bottom: 8px;">
                  OCR ì¸ì‹ ì¤‘... ${progress}%
                </div>
                <div style="font-size: 14px; color: #6b7280;">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</div>
              `;
            }
          }
        });
        
        const { data: { text } } = await worker.recognize(file);
        await worker.terminate();
        
        console.log('ğŸ“ ì¶”ì¶œëœ í…ìŠ¤íŠ¸:', text);
        
        // ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ì¶”ì¶œ
        const businessNumberMatch = text.match(/\d{3}[-\s]?\d{2}[-\s]?\d{5}/);
        if (businessNumberMatch) {
          const number = businessNumberMatch[0].replace(/\s/g, '').replace(/(\d{3})(\d{2})(\d{5})/, '$1-$2-$3');
          document.getElementById('verifyBusinessNumber').value = number;
          console.log('âœ… ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ì¸ì‹:', number);
        }
        
        // ìƒí˜¸ëª… ì¶”ì¶œ
        const namePatterns = [
          /(?:ìƒí˜¸|ë²•ì¸ëª…|íšŒì‚¬ëª…)[\s:ï¼š]*([ê°€-í£a-zA-Z0-9\(\)\s]+)/,
          /([ê°€-í£]{2,}(?:ì£¼ì‹íšŒì‚¬|ìœ í•œíšŒì‚¬|í•©ìíšŒì‚¬|í•©ëª…íšŒì‚¬))/,
          /(?:ì£¼ì‹íšŒì‚¬|ìœ í•œíšŒì‚¬|í•©ìíšŒì‚¬|í•©ëª…íšŒì‚¬)[\s]*([ê°€-í£a-zA-Z0-9]+)/
        ];
        
        for (const pattern of namePatterns) {
          const match = text.match(pattern);
          if (match) {
            const name = match[1].trim();
            document.getElementById('verifyBusinessName').value = name;
            console.log('âœ… ìƒí˜¸ëª… ì¸ì‹:', name);
            break;
          }
        }
        
        // ì„±ê³µ ìƒíƒœ
        uploadArea.innerHTML = `
          <i class="fas fa-check-circle" style="font-size: 48px; color: #10b981; margin-bottom: 12px;"></i>
          <div style="font-size: 16px; font-weight: 600; color: #374151; margin-bottom: 8px;">
            ì—…ë¡œë“œ ì™„ë£Œ!
          </div>
          <div style="font-size: 14px; color: #6b7280;">
            ${file.name} (${(file.size / 1024).toFixed(1)} KB)
          </div>
        `;
        
        // íŒŒì¼ ë¯¸ë¦¬ë³´ê¸°
        const preview = document.getElementById('verificationFilePreview');
        const reader = new FileReader();
        reader.onload = (e) => {
          preview.innerHTML = `
            <img src="${e.target.result}" alt="ì‚¬ì—…ìë“±ë¡ì¦">
            <button onclick="removeVerificationFile()" class="remove-file-btn">
              <i class="fas fa-times"></i> íŒŒì¼ ì œê±°
            </button>
          `;
          preview.style.display = 'block';
        };
        reader.readAsDataURL(file);
        
        console.log('âœ… OCR ì¸ì‹ ì™„ë£Œ');
      } catch (error) {
        console.error('âŒ OCR ì‹¤íŒ¨:', error);
        uploadArea.classList.remove('has-file');
        uploadArea.innerHTML = `
          <i class="fas fa-exclamation-triangle" style="font-size: 48px; color: #f59e0b; margin-bottom: 12px;"></i>
          <div style="font-size: 16px; font-weight: 600; color: #374151; margin-bottom: 8px;">
            ì¸ì‹ ì‹¤íŒ¨
          </div>
          <div style="font-size: 14px; color: #6b7280;">
            ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ì™€ ìƒí˜¸ëª…ì„ ì§ì ‘ ì…ë ¥í•´ì£¼ì„¸ìš”
          </div>
        `;
        alert('âš ï¸ OCR ì¸ì‹ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\nì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ì™€ ìƒí˜¸ëª…ì„ ì§ì ‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      }
      
      checkVerificationFormValidity();
    }

    // íŒŒì¼ ì œê±°
    function removeVerificationFile() {
      verificationBusinessFile = null;
      document.getElementById('verifyBusinessFile').value = '';
      document.getElementById('verificationFilePreview').style.display = 'none';
      
      const uploadArea = document.getElementById('uploadArea');
      uploadArea.classList.remove('has-file');
      uploadArea.innerHTML = `
        <i class="fas fa-cloud-upload-alt" style="font-size: 48px; color: #9ca3af; margin-bottom: 12px;"></i>
        <div style="font-size: 16px; font-weight: 600; color: #374151; margin-bottom: 8px;">
          íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”
        </div>
        <div style="font-size: 14px; color: #6b7280;">
          JPG, PNG íŒŒì¼ë§Œ ê°€ëŠ¥ (ìµœëŒ€ 5MB)
        </div>
      `;
      
      checkVerificationFormValidity();
    }

    // í¼ ìœ íš¨ì„± ê²€ì‚¬
    function checkVerificationFormValidity() {
      const businessNumber = document.getElementById('verifyBusinessNumber')?.value.trim();
      const businessName = document.getElementById('verifyBusinessName')?.value.trim();
      const submitButton = document.getElementById('submitVerificationButton');
      
      if (submitButton && businessNumber && businessName && verificationBusinessFile) {
        submitButton.disabled = false;
        submitButton.style.opacity = '1';
      } else if (submitButton) {
        submitButton.disabled = true;
        submitButton.style.opacity = '0.6';
      }
    }

    // ì…ë ¥ í•„ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    window.addEventListener('DOMContentLoaded', () => {
      const businessNumberInput = document.getElementById('verifyBusinessNumber');
      const businessNameInput = document.getElementById('verifyBusinessName');
      
      if (businessNumberInput) {
        businessNumberInput.addEventListener('input', checkVerificationFormValidity);
      }
      if (businessNameInput) {
        businessNameInput.addEventListener('input', checkVerificationFormValidity);
      }
    });

    // êµ¬ì¸ì ì¸ì¦ ì‹ ì²­
    async function submitEmployerVerification() {
      const businessNumber = document.getElementById('verifyBusinessNumber').value.trim();
      const businessName = document.getElementById('verifyBusinessName').value.trim();
      
      if (!businessNumber || !businessName || !verificationBusinessFile) {
        alert('ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      const submitButton = document.getElementById('submitVerificationButton');
      submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ì‹ ì²­ ì¤‘...';
      submitButton.disabled = true;
      
      try {
        const formData = new FormData();
        formData.append('business_registration_number', businessNumber);
        formData.append('business_name', businessName);
        formData.append('business_registration_file', verificationBusinessFile);
        
        const sessionToken = localStorage.getItem('albi_session_token');
        const response = await fetch('/api/employer/request-verification', {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${sessionToken}`
          },
          body: formData
        });
        
        const data = await response.json();
        
        if (data.success) {
          alert('âœ… êµ¬ì¸ì ì¸ì¦ ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\nì‹¬ì‚¬ëŠ” ìµœëŒ€ 1-2ì¼ ì •ë„ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
          
          // í¼ ì´ˆê¸°í™”
          document.getElementById('verifyBusinessNumber').value = '';
          document.getElementById('verifyBusinessName').value = '';
          removeVerificationFile();
          
          // ìƒíƒœ ë‹¤ì‹œ ë¡œë“œ
          loadEmployerVerificationStatus();
        } else {
          alert('âŒ ì‹ ì²­ ì‹¤íŒ¨: ' + (data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'));
          submitButton.innerHTML = '<i class="fas fa-paper-plane"></i> ì¸ì¦ ì‹ ì²­í•˜ê¸°';
          submitButton.disabled = false;
        }
      } catch (error) {
        console.error('êµ¬ì¸ì ì¸ì¦ ì‹ ì²­ ì‹¤íŒ¨:', error);
        alert('âŒ ì¸ì¦ ì‹ ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        submitButton.innerHTML = '<i class="fas fa-paper-plane"></i> ì¸ì¦ ì‹ ì²­í•˜ê¸°';
        submitButton.disabled = false;
      }
    }
  </script>
</body>
</html>
