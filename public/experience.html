<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>1ì‹œê°„ ì²´í—˜ ì§„í–‰ ì¤‘ - ì•Œë¹„</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .pulse-animation { animation: pulse 2s infinite; }
    
    @keyframes slideIn {
      from {
        transform: translateY(-100px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    .slide-in { animation: slideIn 0.5s ease-out; }
  </style>
</head>
<body class="bg-gray-50">
  <div class="max-w-md mx-auto min-h-screen p-4">
    <!-- ê¸´ê¸‰ ì¤‘ë‹¨ ë²„íŠ¼ -->
    <div class="fixed top-4 right-4 z-50">
      <button onclick="emergencyStop()" 
              class="bg-red-500 text-white px-4 py-2 rounded-full font-bold shadow-lg hover:bg-red-600 flex items-center space-x-1">
        <span>âš ï¸</span>
        <span>ê¸´ê¸‰ì¤‘ë‹¨</span>
      </button>
    </div>

    <!-- í—¤ë” -->
    <div class="bg-white p-4 rounded-xl shadow-sm mb-6 flex justify-between items-center">
      <div class="flex items-center space-x-2">
        <span>ğŸ“</span>
        <span class="font-bold text-gray-800" id="jobTitle">í™ëŒ€ â—‹â—‹ì¹´í˜</span>
      </div>
      <div class="bg-orange-100 text-orange-600 px-3 py-1 rounded-full text-sm font-bold flex items-center space-x-1">
        <span>ğŸ†</span>
        <span id="pointsDisplay">0 P</span>
      </div>
    </div>

    <!-- ì•ˆì „ ê²½ê³  -->
    <div class="bg-yellow-50 border-2 border-yellow-200 rounded-xl p-4 mb-6">
      <div class="flex items-center space-x-2 mb-2">
        <span class="text-yellow-600">âš ï¸</span>
        <span class="font-bold text-yellow-800">No-Touch Rule</span>
      </div>
      <p class="text-sm text-yellow-700">
        1ì‹œê°„ ë™ì•ˆ <strong>ì ˆëŒ€ ì¼í•˜ì§€ ì•Šê³ </strong> ê´€ì°°ê³¼ ì§ˆë¬¸ë§Œ í•´ì£¼ì„¸ìš”.<br>
        ë¹—ìë£¨, ê³„ì‚°, ì„œë¹™ ë“± ëª¨ë“  ì—…ë¬´ëŠ” <strong class="text-red-600">ê¸ˆì§€</strong>ì…ë‹ˆë‹¤.
      </p>
    </div>

    <!-- íƒ€ì´ë¨¸ -->
    <div class="text-center mb-8">
      <div id="timer" class="text-6xl font-mono font-bold text-gray-800 mb-4">60:00</div>
      <button onclick="toggleTimer()" id="timerButton"
              class="px-8 py-3 rounded-full font-bold text-white bg-orange-500 hover:bg-orange-600 transition">
        ì²´í—˜ ì‹œì‘
      </button>
    </div>

    <!-- í˜„ì¬ ë¯¸ì…˜ ì¹´ë“œ -->
    <div id="missionCard" class="bg-blue-50 border-2 border-blue-200 p-6 rounded-2xl shadow-lg mb-6">
      <div class="flex justify-between items-start mb-4">
        <div>
          <h3 class="text-xl font-bold text-gray-800 mb-1" id="missionTitle">ğŸ” í™˜ê²½ ê´€ì°° ë¯¸ì…˜</h3>
          <p class="text-sm text-gray-600" id="missionTime">0~20ë¶„</p>
        </div>
        <div class="bg-white px-3 py-1 rounded-full text-sm font-bold text-orange-600" id="missionReward">
          +15P
        </div>
      </div>
      
      <p class="text-gray-700 mb-4" id="missionDescription">
        ë§¤ì¥ì˜ ì²­ê²°ë„ì™€ ë¶„ìœ„ê¸°ë¥¼ ê´€ì°°í•˜ì„¸ìš”. ì•ˆì „í•œ ê³³ì—ì„œ ì§€ì¼œë³´ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.
      </p>
      
      <div class="space-y-2 mb-4" id="missionTasks">
        <div class="flex items-center space-x-2 text-sm">
          <div class="w-2 h-2 bg-orange-400 rounded-full"></div>
          <span>ë§¤ì¥ ì²­ê²°ë„ 5ì  ì²™ë„ë¡œ í‰ê°€</span>
        </div>
        <div class="flex items-center space-x-2 text-sm">
          <div class="w-2 h-2 bg-orange-400 rounded-full"></div>
          <span>ê³ ê°ì´ ë§ì´ ì°¾ëŠ” ìƒí’ˆ 3ê°€ì§€ í™•ì¸</span>
        </div>
        <div class="flex items-center space-x-2 text-sm">
          <div class="w-2 h-2 bg-orange-400 rounded-full"></div>
          <span>ë¹„ìƒêµ¬ ìœ„ì¹˜ íŒŒì•…</span>
        </div>
      </div>

      <button onclick="completeMission()" id="missionButton"
              class="w-full py-3 rounded-lg font-bold bg-white text-gray-800 hover:bg-gray-100 border-2 border-gray-200 transition">
        ë¯¸ì…˜ ì™„ë£Œí•˜ê³  +15P ë°›ê¸°
      </button>
    </div>

    <!-- ì§„í–‰ ìƒí™© -->
    <div class="bg-white p-4 rounded-xl shadow-sm">
      <h4 class="font-bold mb-3">ì „ì²´ ì§„í–‰ ìƒí™©</h4>
      <div class="space-y-2" id="progressList">
        <div class="flex items-center justify-between text-sm">
          <span class="text-gray-500">â¬œ ğŸ” í™˜ê²½ ê´€ì°° ë¯¸ì…˜</span>
          <span class="text-orange-500 font-bold">15P</span>
        </div>
        <div class="flex items-center justify-between text-sm">
          <span class="text-gray-500">â¬œ ğŸ‘€ ì—…ë¬´ ê´€ì°° ë¯¸ì…˜</span>
          <span class="text-orange-500 font-bold">15P</span>
        </div>
        <div class="flex items-center justify-between text-sm">
          <span class="text-gray-500">â¬œ ğŸ’¬ ì†Œí†µ ë¯¸ì…˜</span>
          <span class="text-orange-500 font-bold">20P</span>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ì „ì—­ ë³€ìˆ˜
    let timeLeft = 3600; // 60ë¶„
    let isActive = false;
    let currentPhase = 0;
    let points = 0;
    let completedMissions = [];
    let timerInterval;

    const missions = [
      {
        phase: 0,
        timeRange: "0~20ë¶„",
        title: "ğŸ” í™˜ê²½ ê´€ì°° ë¯¸ì…˜",
        description: "ë§¤ì¥ì˜ ì²­ê²°ë„ì™€ ë¶„ìœ„ê¸°ë¥¼ ê´€ì°°í•˜ì„¸ìš”. ì•ˆì „í•œ ê³³ì—ì„œ ì§€ì¼œë³´ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.",
        tasks: [
          "ë§¤ì¥ ì²­ê²°ë„ 5ì  ì²™ë„ë¡œ í‰ê°€",
          "ê³ ê°ì´ ë§ì´ ì°¾ëŠ” ìƒí’ˆ 3ê°€ì§€ í™•ì¸",
          "ë¹„ìƒêµ¬ ìœ„ì¹˜ íŒŒì•…"
        ],
        reward: 15,
        bgColor: "bg-blue-50",
        borderColor: "border-blue-200"
      },
      {
        phase: 1,
        timeRange: "20~40ë¶„",
        title: "ğŸ‘€ ì—…ë¬´ ê´€ì°° ë¯¸ì…˜",
        description: "ì§ì›ë“¤ì˜ ì—…ë¬´ë¥¼ ê´€ì°°í•˜ì„¸ìš”. ì ˆëŒ€ ë„ì™€ë“œë¦¬ë ¤ í•˜ì§€ ë§ˆì„¸ìš”!",
        tasks: [
          "ê°€ì¥ ìì£¼ í•˜ëŠ” ì—…ë¬´ 3ê°€ì§€ ê´€ì°°",
          "ë°”ìœ ì‹œê°„ëŒ€ì™€ í•œê°€í•œ ì‹œê°„ íŒŒì•…",
          "ì—…ë¬´ ë‚œì´ë„ ì²´í¬ (ì‰¬ì›€/ë³´í†µ/ì–´ë ¤ì›€)"
        ],
        reward: 15,
        bgColor: "bg-purple-50",
        borderColor: "border-purple-200"
      },
      {
        phase: 2,
        timeRange: "40~60ë¶„",
        title: "ğŸ’¬ ì†Œí†µ ë¯¸ì…˜",
        description: "ì‚¬ì¥ë‹˜ì´ë‚˜ ì§ì›ë¶„ê»˜ ê¶ê¸ˆí•œ ì ì„ ì§ˆë¬¸í•˜ì„¸ìš”.",
        tasks: [
          "ê°€ì¥ ë°”ìœ ì‹œê°„ëŒ€ ì§ˆë¬¸í•˜ê¸°",
          "ì§ì› ë³µì§€ë‚˜ í˜œíƒ ë¬¸ì˜",
          "ì¼í•˜ë©´ì„œ í˜ë“  ì  ì§ˆë¬¸"
        ],
        reward: 20,
        bgColor: "bg-green-50",
        borderColor: "border-green-200"
      }
    ];

    // íƒ€ì´ë¨¸ í† ê¸€
    function toggleTimer() {
      isActive = !isActive;
      const button = document.getElementById('timerButton');
      
      if (isActive) {
        button.textContent = 'ì¼ì‹œì •ì§€';
        button.className = 'px-8 py-3 rounded-full font-bold text-white bg-gray-400 transition';
        startTimer();
      } else {
        button.textContent = 'ì²´í—˜ ì¬ê°œ';
        button.className = 'px-8 py-3 rounded-full font-bold text-white bg-orange-500 hover:bg-orange-600 transition';
        stopTimer();
      }
    }

    // íƒ€ì´ë¨¸ ì‹œì‘
    function startTimer() {
      timerInterval = setInterval(() => {
        if (timeLeft > 0) {
          timeLeft--;
          updateTimer();
          checkPhaseChange();
        } else {
          completeExperience();
        }
      }, 1000);
    }

    // íƒ€ì´ë¨¸ ì •ì§€
    function stopTimer() {
      clearInterval(timerInterval);
    }

    // íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸
    function updateTimer() {
      const minutes = Math.floor(timeLeft / 60);
      const seconds = timeLeft % 60;
      document.getElementById('timer').textContent = 
        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }

    // í˜ì´ì¦ˆ ë³€ê²½ ì²´í¬
    function checkPhaseChange() {
      const elapsed = 3600 - timeLeft;
      let newPhase = currentPhase;
      
      if (elapsed >= 2400) newPhase = 2; // 40ë¶„ ê²½ê³¼
      else if (elapsed >= 1200) newPhase = 1; // 20ë¶„ ê²½ê³¼
      else newPhase = 0;
      
      if (newPhase !== currentPhase && !completedMissions.includes(newPhase)) {
        currentPhase = newPhase;
        updateMissionCard();
        showPhaseChangeNotification();
      }
    }

    // í˜ì´ì¦ˆ ë³€ê²½ ì•Œë¦¼
    function showPhaseChangeNotification() {
      const mission = missions[currentPhase];
      const notification = document.createElement('div');
      notification.className = 'fixed top-20 left-1/2 transform -translate-x-1/2 bg-white p-4 rounded-xl shadow-2xl z-50 slide-in';
      notification.innerHTML = `
        <div class="text-center">
          <div class="text-3xl mb-2">${mission.title.split(' ')[0]}</div>
          <div class="font-bold text-gray-800">${mission.title}</div>
          <div class="text-sm text-gray-600">${mission.timeRange}</div>
        </div>
      `;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, 3000);
    }

    // ë¯¸ì…˜ ì¹´ë“œ ì—…ë°ì´íŠ¸
    function updateMissionCard() {
      const mission = missions[currentPhase];
      const card = document.getElementById('missionCard');
      
      card.className = `${mission.bgColor} ${mission.borderColor} border-2 p-6 rounded-2xl shadow-lg mb-6`;
      document.getElementById('missionTitle').textContent = mission.title;
      document.getElementById('missionTime').textContent = mission.timeRange;
      document.getElementById('missionDescription').textContent = mission.description;
      document.getElementById('missionReward').textContent = `+${mission.reward}P`;
      
      // íƒœìŠ¤í¬ ì—…ë°ì´íŠ¸
      const tasksHtml = mission.tasks.map(task => `
        <div class="flex items-center space-x-2 text-sm">
          <div class="w-2 h-2 bg-orange-400 rounded-full"></div>
          <span>${task}</span>
        </div>
      `).join('');
      document.getElementById('missionTasks').innerHTML = tasksHtml;
      
      // ë²„íŠ¼ ìƒíƒœ
      const button = document.getElementById('missionButton');
      if (completedMissions.includes(currentPhase)) {
        button.textContent = 'âœ… ì™„ë£Œ!';
        button.className = 'w-full py-3 rounded-lg font-bold bg-green-500 text-white cursor-default';
        button.disabled = true;
      } else {
        button.textContent = `ë¯¸ì…˜ ì™„ë£Œí•˜ê³  +${mission.reward}P ë°›ê¸°`;
        button.className = 'w-full py-3 rounded-lg font-bold bg-white text-gray-800 hover:bg-gray-100 border-2 border-gray-200 transition';
        button.disabled = false;
      }
    }

    // ë¯¸ì…˜ ì™„ë£Œ
    function completeMission() {
      if (completedMissions.includes(currentPhase)) return;
      
      const mission = missions[currentPhase];
      points += mission.reward;
      completedMissions.push(currentPhase);
      
      // í¬ì¸íŠ¸ í‘œì‹œ ì—…ë°ì´íŠ¸
      document.getElementById('pointsDisplay').textContent = `${points} P`;
      
      // í¬ì¸íŠ¸ íšë“ ì• ë‹ˆë©”ì´ì…˜
      showPointAnimation(`+${mission.reward}P`);
      
      // ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸
      updateProgress();
      
      // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
      updateMissionCard();
    }

    // í¬ì¸íŠ¸ ì• ë‹ˆë©”ì´ì…˜
    function showPointAnimation(text) {
      const animation = document.createElement('div');
      animation.textContent = text;
      animation.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-6xl font-bold text-orange-500 z-50 pulse-animation';
      document.body.appendChild(animation);
      
      setTimeout(() => {
        animation.remove();
      }, 2000);
    }

    // ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸
    function updateProgress() {
      const progressHtml = missions.map((mission, index) => {
        const isCompleted = completedMissions.includes(index);
        return `
          <div class="flex items-center justify-between text-sm">
            <span class="${isCompleted ? 'text-green-600' : 'text-gray-500'}">
              ${isCompleted ? 'âœ…' : 'â¬œ'} ${mission.title}
            </span>
            <span class="text-orange-500 font-bold">${mission.reward}P</span>
          </div>
        `;
      }).join('');
      document.getElementById('progressList').innerHTML = progressHtml;
    }

    // ê¸´ê¸‰ ì¤‘ë‹¨
    function emergencyStop() {
      if (confirm("âš ï¸ ì •ë§ ì²´í—˜ì„ ì¤‘ë‹¨í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì¤‘ë‹¨ ì‚¬ìœ :\n- ì•ˆì „ ë¬¸ì œ\n- ì—…ë¬´ ê°•ìš”\n- ë¶ˆí¸í•œ ìƒí™©\n\níšë“í•œ í¬ì¸íŠ¸ëŠ” ìœ ì§€ë©ë‹ˆë‹¤.")) {
        isActive = false;
        stopTimer();
        
        if (confirm("ğŸš¨ ê¸´ê¸‰ ìƒí™©ì¸ê°€ìš”?\n24ì‹œê°„ ìƒë‹´ì› ì—°ê²°ì„ ì›í•˜ì‹œë©´ 'í™•ì¸'ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.")) {
          window.location.href = 'tel:1588-0000';
        } else {
          // ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™
          window.location.href = '/';
        }
      }
    }

    // ì²´í—˜ ì™„ë£Œ
    function completeExperience() {
      stopTimer();
      alert(`ğŸ‰ ì²´í—˜ ì™„ë£Œ!\n\nì´ íšë“ í¬ì¸íŠ¸: ${points} P\n\nì´ì œ ì´ ì§ì¥ì—ì„œ ì¼í•˜ê³  ì‹¶ì€ì§€ ê²°ì •í•´ì£¼ì„¸ìš”!`);
      
      // í¬ì¸íŠ¸ ì €ì¥
      const savedPoints = parseInt(localStorage.getItem('albi_points') || '0');
      localStorage.setItem('albi_points', (savedPoints + points).toString());
      
      // ê²°ì • í˜ì´ì§€ë¡œ ì´ë™ (ì„ì‹œë¡œ ë©”ì¸ í˜ì´ì§€)
      window.location.href = '/';
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    window.onload = function() {
      updateMissionCard();
      updateProgress();
      
      // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì§ì¥ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
      const urlParams = new URLSearchParams(window.location.search);
      const jobTitle = urlParams.get('job') || 'í™ëŒ€ â—‹â—‹ì¹´í˜';
      document.getElementById('jobTitle').textContent = jobTitle;
    };

    // í˜ì´ì§€ ì´íƒˆ ë°©ì§€ (íƒ€ì´ë¨¸ ì§„í–‰ ì¤‘)
    window.addEventListener('beforeunload', function(e) {
      if (isActive) {
        e.preventDefault();
        e.returnValue = '';
        return 'íƒ€ì´ë¨¸ê°€ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ì •ë§ ë‚˜ê°€ì‹œê² ìŠµë‹ˆê¹Œ?';
      }
    });
  </script>
</body>
</html>
